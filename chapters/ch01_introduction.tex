%!TEX root = ../report.tex
\documentclass[../report.tex]{subfiles}
\begin{document}
    \chapter{Introduction}
	 \enquote {Artificial Neural Networks (ANNs) are increasingly applied for medical image diagnostics} \cite{anwar2018medical}. Medical image data such as scans produced from imaging devices like x-rays \cite{ozturk2020automated}, Magnetic Resonance Imaging (MRI) \cite{xue2012window}, Computed Tomography (CT) \cite{lee2019explainable}, and ultra sound \cite{qian2021prospective}, waveforms produced from procedures like ElectroCardioGraphy (ECG) \cite{hicks2021explaining} and ElectroEncephaloGraphy (EEG), histological images \cite{binder2021morphological}, images of body parts, and admission notes \cite{li2017convolutional} are fed into ANNs to perform tasks such as segmentation \cite{Schwendicke2019}, classification \cite{Gurovich2019} and abnormality detection \cite{binder2021morphological}.
	
	Predictions made by neural network models are typically intended to be used in a clinical setting, to aid medical practitioners in diagnosing their patients. As a result, it can help in an overall reduction of \enquote{misdiagnosis}, which is one of the most severe problems in health care \cite{li2017convolutional}. Besides, the adoption of ANN based Artificial Intelligence (AI) systems facilitates early screening and identification of life-threatening conditions such as cancer in population with limited or no access to sub-specialty trained clinicians.
	
	ANN models such as the ones used in AI systems for intracranial haemorrhage classification \cite{lee2019explainable} and breast cancer prediction  \cite{mckinney2020international} are claimed to outperform clinicians in their respective tasks. In spite of their success in terms of predictive performance, the black box nature of ANNs restrains them from getting deployed in a clinical setting. Inherently, ANNs lack transparency and therefore are considered to be less dependable for high stake applications like medical diagnosis and autonomous driving. Besides, regulatory bodies such as \enquote{US FDA (United States Food and Drug Administration) require any clinical decision support software to explain the rationale or support for its decisions to enable the users to independently review the basis of their recommendations} \cite{lee2019explainable}. Such contradictions further restrict the deployment of ANN based AI systems for performing medical diagnoses in a clinical setting.
	
	\enquote{Explainable Artificial Intelligence (XAI) is a set of processes and methods that allows human users to comprehend and trust the results and output created by machine learning algorithms} \cite{BibEntry2021Mar}. Application of XAI techniques to Machine Learning (ML) models enables its human users to better understand their behavior and rationale behind their predictions. As a result, they improve transparency of models like ANNs, in turn making them more trustworthy for applications like medical diagnosis.
	
	In the recent times, there has been a steep rise in the adoption of XAI methods to explain ANN models for medical diagnoses. A considerable number existing works focus on explaining neural network models that use radiological image data to perform tasks such as COVID classification \cite{ghoshal2020estimating}, breast cancer risk assessment \cite{qian2021prospective} and haemorrhage detection \cite{lee2019explainable} respectively. A few other leverage XAI techniques to explain neural network models used for detecting cancer from histopathological \cite{binder2021morphological} and skin images \cite{nunnari2021overlap}. 
	
	The objective of this thesis is to use XAI to explain one such neural network model called GestaltMatcher \cite{hsieh2022gestaltmatcher}, which surpasses the performance of clinical practitioners in the identification of certain rare genetic syndromes, from frontal facial images of patients. The findings of this work shall make the GestaltMatcher model more transparent and dependable, thereby taking it a step closer to be deployed in a clinical setting.
	
	%The objective of this thesis is to apply suitable XAI techniques to one such state-of-the-art (SOTA) genetic syndrome recognition model called GestaltMatcher \cite{hsieh2022gestaltmatcher}, whose performance surpasses that of clinicians. with intents to make the models explainable and to determine their attention regions in a given facial image. The following subsections describe the motivation behind pursuing this work and lists the relevant research questions that are addressed by this thesis.% 
	

    \section{Motivation}
    \enquote{Rare genetic disorders affect more than 6.2\% of global population} \cite{hsieh2022gestaltmatcher}. A significant fraction of the population with certain such disorders are characterized by facial abnormalities, which make up their respective facial phenotypes. The facial phenotypic information is used by clinical geneticists along with results from other laboratory tests such as molecular, to reach a diagnosis. However, the rarity in occurrence of such disorders combined with the lack of distinctive traits for a subset of them, makes their diagnosis a challenging task even for experienced medical practitioners.  
    
    ANN models such as the ones presented in DeepGestalt \cite{Gurovich2019} and GestaltMatcher \cite{hsieh2022gestaltmatcher} comprise a promising step forward in using AI for the task of recognizing rare genetic disorders from facial phenotypes. Such works rely on databases like Face2Gene \cite{face2gene} and GestaltMatcher database (GMDB) \cite{gmdb}  which offer a valuable collection of frontal facial images and other medical data of the patients with such rare disorders. The GestaltMatcher \cite{hsieh2022gestaltmatcher} model surpasses human expert's performance in the task of recognizing certain syndromes and their sub types. Therefore, deployment of such models in a clinical setting has the potential to significantly improve the speed and accuracy of diagnoses.
    
    The constraints on deploying ANN models for medical diagnoses in a clinical setting, as discussed in the previous section, apply to the genetic disorder classifiers as well. Therefore, there is an obligation for such models to provide bases for their predictions in order to make them dependable. However, none of the existing works on genetic disorder classification from frontal facial images focus on the explainability of their models.
    
    In general, ANN models are capable of learning novel discriminative features or regions from the training data, that are relevant to the task at hand. Associating such learned features or regions with the real world knowledge (with respect to the dataset) can provide new insights about the data and task at hand. In the case of genetic disorder classification, associating attention regions of SOTA models like DeepGestalt \cite{Gurovich2019} and GestaltMatcher \cite{hsieh2022gestaltmatcher} in their frontal facial input images can enhance human kind's understanding about facial phenotypes of genetic disorders. Such a study to associate the attention regions of genetic disorder classifiers with the facial phenotypic information known to the medical community, is yet to be conducted.
    
    \section{Importance} \label{sec_importance}
    Making a genetic disorder classifier explainable by determining its attention regions, offers a means for its users to check whether the model focuses on features relevant to a given disorder, or something irrelevant like background, for example. In the former case, a clinician could use the model's prediction to reinforce their diagnoses. In the latter, they could simply ignore its decisions. Thus an explainable genetic disorder classifier provides a verifiable second opinion to a clinical geneticist.
    
    The knowledge about facial phenotypes of rare genetic disorders are contained in resources like Human Phenotype Ontology (HPO) \cite{hpo} and relevant medical literature. However, due to rare occurrences of such disorders, not all variations in their phenotypes are known to the medical community. Analyzing the attention regions of genetic disorder classifier models offers a way to discover facial regions that contain novel phenotypic traits, there by enhancing human kind's understanding of such rare medical conditions.
    
    Datasets like GMDB \cite{gmdb} only contain a fractional number of instances per class, when compared with sizes of general purpose image classification datasets like ImageNet \cite{deng2009imagenet}. Most of the disorder classes contains samples in the order of tens and a few in the order of hundreds. This in turn demands use of highly effective data pre-processing and model training techniques to learn the most from a dataset. Analyzing attention regions of a classifier model trained on such datasets, enables an ML practitioner to identify any possible biases that the model could have learned, and consecutively enables him to adopt suitable techniques to remove them. This eventually makes the model more generalized and possibly increases its predictive performance. 
    
    \section{Challenges and Difficulties} \label{sec_challenges}
    This section lists and discusses some of the key challenges associated with this research work.
	\begin{itemize}
		\item \textbf{Dataset size and imbalance: }As briefly mentioned in the previous section, datasets like GMDB \cite{hsieh2022gestaltmatcher} are small-sized, and also are characterized by problems such as dataset imbalance and low image resolution. Figure \ref{} depicts the class-wise distribution of samples in GMDB. Such problems are caused by various factors like inherent rarity in occurrence of genetic syndromes, data-privacy constraints and lack of openly available datasets. The above listed issues of genetic syndrome datasets often have consequential effects on the performance and explainability of machine learning models they are trained with. 

		\item \textbf{Low predictive performance of the classifier: }Although, SOTA genetic syndrome classifier models such as DeepGestalt \cite{Gurovich2019} and GestaltMatcher \cite{hsieh2022gestaltmatcher} surpass human-level performance in diagnosing rare genetic disorders, their predictive perfomances are exceptionally low when compared with that of top classification models trained on large general purpose datasets. Besides, over-fitting is a common problem experienced by these models. In most of the existing works on XAI methods for neural networks, the research community has benchmarked them on high performance models. This raises doubts about the quality of explanations generated by XAI methods, when applied to low performance models.
	
		\item \textbf{Lack of ground truth explanations: }Evaluating the performance and effectiveness of XAI methods remains a challenge till date. In most of the cases, this is due to the lack of any ground truth and/or metrics to evaluate their explanations. Besides, the working principle of every XAI method is different, with each focusing on explaining a particular aspect of model and its predictions. Due to this reason, often XAI methods are evaluated by subjecting their corresponding artifacts to be assessed by humans. In the case of this work, such an evaluation needs to be performed by clinicians and dysmorphologists who specialize in the diagnosis of rare genetic syndromes. Certain practical difficulties in conducting such an evaluation like the willingness of clinicians to participate in the process pose a challenge. In addition, new findings and discoveries about phenotypic features and new variants of genetic syndromes change the medical community's understanding of them time to time, questioning the correctness of clinical evaluation conducted at a given point in time.
\end{itemize}
   
    \section{Problem Statement}
 	This research work systematically approaches the problem in hand. Firstly, a literature review is conducted to identify SOTA XAI methods, which when applied to the GestaltMatcher model explains the rationale behind its predictions, in the form of post-hoc attention maps. In a classification setup, post-hoc attention heat maps such as the ones in Figure \ref{}, signal regions in the input image that were relevant for a classifier model to produce a certain class label. A handful of XAI methods are shortlisted based on their advantages and drawbacks, recommendations from the research community, and their suitability to the task at hand. 
 	
 	The selected set of techniques are applied to GestaltMatcher \cite{hsieh2022gestaltmatcher}, in order to generate explanations associated with the model's predictions for every patient image in the GMDB \cite{hsieh2022gestaltmatcher} dataset. The generated explanations are then analyzed with intents to understand the behaviours of both the model and the chosen set of XAI techniques with different input categories. Besides analyzing the model's regions of interest in individual patient images, this work also studies its characteristic attention regions on a class level for specific syndromes. Such characteristic representations are produced by combining patient-wise attention maps of individual classes. 
 	
 	As mentioned in \ref{sec_challenges}, dataset imbalance is one of the key challenges in the application of machine learning technqiues to medical data. This can have consequences on the quality of attention maps generated for classes of different sizes. This work conducts experiments to analyze the effects of class imbalance on the quality of explanation artifacts. This is achieved by comparing attention maps, produced from classifier models that are trained with different numbers and choices for the syndrome classes. 
 	
 	Inorder to know the association between GestaltMatcher's attention regions and the medical community's knowledge on facial phenotypic features of genetic syndromes, the model's attention maps need to be evaluated by clinicians. It is a time-consuming process which involves the participation of atleast a few dysmorphologists and sub-specialty trained clinicians. Such an evaluation is not included in this work, due to the time constraints, however, a questionnaire to facilitate the process in future is formulated and presented. Besides, this thesis also suggests and proposes ways to quantitatively evaluate the attention maps. 
 	
 	Finally, a use case scenario is presented, depicting the application of techniques presented in this work to a real-world genetic syndrome diagnosis situation.
 	
 	 
 	\subsubsection{Research Questions} \label{sec_rq}
 	Concisely put, this thesis intends to address the following research questions:% 
 	\begin{enumerate}
 		\item [] \textbf{RQ1.} What are the XAI methods to determine important regions in an input image for a CNN based classifier model to make its predictions?  
 		\item [] \textbf{RQ2.} What are the key regions in frontal facial images fed to CNN models trained for the task of classifying rare genetic disorders?
 		\item [] \textbf{RQ3.} How do the regions obtained from findings for RQ2 compare with the knowledge known to the medical community on facial phenotypes of the corresponding rare genetic disorders? 
 	\end{enumerate}
 
 	\section{Structure}
 	This report consists of seven chapters (including this chapter) with each discussing different aspects of the conducted research work. The first chapter introduced the reader to the research topic, and discusses the scope and significance of this work. Chapter 2 gives the necessary background knowledge of rare genetic syndromes and their diagnoses using GestaltMatcher \cite{hsieh2022gestaltmatcher}, which is necessary to appreciate this work. The chapter also briefly introduces the reader to the field of XAI and discusses the taxonomy of explanation methods. In Chapter 3, a literature review of SOTA explanation methods considered for this research work is provided. Chapter 4 describes the systematic approach taken to address the problem at hand. The chapter gives the rationale behind the design of experiments and other choices made. The fifth chapter discusses implementation details and provides specifications of datasets and models used for experimentation. The results obtained from the conducted experiments are listed and analyzed in Chapter 6. Besides, it also presents and describes the formulated evaluation questionnaire. Finally, Chapter 7 concludes the report by summarizing the contributions of this project, and also discusses the possible future research directions. 
 	
 	
\end{document}
